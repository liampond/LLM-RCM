[TextBlock(text='Let me analyze this step by step:

1. Key of the melody:
- Looking at the key signature, there are 2 sharps (F# and C#)
- According to the key signature table, this indicates either D major or B minor
- Looking at the melody and final cadence, it clearly centers around D and ends on a D major chord
Therefore, the key is D major

2. Second last chord (measure 3):
- Bass note is A (root)
- Notes from bottom to top: A, E, A, C#
- Has a major third (C#) above the root (A)
- This forms an A major chord
Root/quality symbol: A

3. Last chord (measure 4):
- Bass note is F#
- Notes from bottom to top: F#, A, D
- Has a major third (A) above the root (F#)
- Forms a D major chord with F# in the bass
Root/quality symbol: D

4. Functional symbols:
- In D major:
  - A (second last chord) is built on scale degree 5 = V
  - D (last chord) is built on scale degree 1 = I

5. Cadence type:
- The progression moves from V to I
- Since it ends on tonic (I), this is an authentic cadence

Final answers:
- Key: D major
- Second last chord root/quality: A
- Last chord root/quality: D
- Second last chord function: V
- Last chord function: I
- Cadence type: Authentic