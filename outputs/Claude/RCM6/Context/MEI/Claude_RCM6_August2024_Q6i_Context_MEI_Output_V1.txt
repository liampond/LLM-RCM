[TextBlock(text="I'll analyze this step by step.

1. Key of the melody:
- The key signature has 3 flats (B♭, E♭, A♭)
- Looking at the table, this corresponds to either E♭ major or C minor
- Looking at the melody and final cadence, it resolves to G, and uses B natural (raised 7th) leading to C
- Therefore, this piece is in C minor

2. Second last chord (measure 3):
- Notes from bottom to top: G, C, E♭
- Root is G
- Third above root (B natural) is not present
- This appears to be a C minor chord in first inversion
- Root/quality chord symbol: Cm

3. Last chord (measure 4):
- Notes from bottom to top: G, B♮, D
- Root is G
- Has major third (B natural)
- Root/quality chord symbol: G

4. Functional chord symbols:
- Second last chord (Cm): i
- Last chord (G): V

5. Cadence type:
- The progression moves from i to V
- The final chord is V (dominant)
- Therefore, this is a half cadence

Final answer:
- Key: C minor
- Second last chord root/quality: Cm
- Last chord root/quality: G
- Second last functional symbol: i
- Last functional symbol: V
- Cadence type: Half cadence", type='text')]