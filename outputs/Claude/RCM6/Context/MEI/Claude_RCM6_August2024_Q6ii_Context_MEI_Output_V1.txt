[TextBlock(text="I'll help determine each element step by step.

1. Key of the melody:
- Looking at the key signature, there are 2 sharps (F# and C#)
- According to the key signature table, this indicates either D major or B minor
- Looking at the melody and final cadence, it clearly centers around D
- Therefore, the key is D major

2. Second last chord (measure 3):
- Notes from bottom to top: E, A, C#
- Root is A (bass note)
- With C# (major third) above A
- This forms A major
- Root/quality chord symbol: A

3. Last chord (measure 4):
- Notes from bottom to top: F#, A, D
- Root is D (bass note F#)
- With F# (major third) and A (perfect fifth) above D
- This forms D major
- Root/quality chord symbol: D

4. Functional chord symbols:
- In D major:
  - A major is built on scale degree 5 → V
  - D major is built on scale degree 1 → I

5. Cadence type:
- The progression moves from V → I
- Since it ends on tonic (I), this is an authentic cadence

Final answers:
- Key: D major
- Second last chord root/quality: A
- Last chord root/quality: D
- Second last chord function: V
- Last chord function: I
- Cadence type: Authentic", type='text')]