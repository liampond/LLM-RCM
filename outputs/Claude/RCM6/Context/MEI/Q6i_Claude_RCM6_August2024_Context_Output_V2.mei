[TextBlock(text='Let me analyze this step by step:

1. Key of the melody:
- Looking at the key signature, there are 3 flats (Bb, Eb, Ab)
- According to the key signature table, this could be Eb major or C minor
- Looking at the melody and final cadence, it resolves to G, with prominent use of G, B natural (raised leading tone), and D
- Therefore, this is in C minor

2. Second last chord (measure 3):
- Notes from bottom to top: G, C, Eb
- Root is G
- Third above root (B) is not present
- This appears to be a C minor chord in first inversion
- Root/quality symbol: Cm

3. Last chord (measure 4):
- Notes from bottom to top: G, Bn, D
- Root is G
- Has major third (B natural)
- Root/quality symbol: G

4. Functional symbols:
- Second last chord (Cm): i
- Last chord (G): V

5. Cadence type:
- The progression moves from i to V
- Final chord is V (dominant)
- Therefore, this is a half cadence

Final answers:
- Key: C minor
- Second last chord root/quality: Cm
- Last chord root/quality: G
- Second last chord function: i
- Last chord function: V
- Cadence type: Half cadence